# ä¸´æ—¶é‚®ç®±æ¥ç å·¥å…· - å¾®æœåŠ¡ç‰ˆ

ä¸€ä¸ªåŸºäºå¾®æœåŠ¡æ¶æ„å’ŒVue 3çš„ç°ä»£åŒ–ä¸´æ—¶é‚®ç®±æ¥ç å·¥å…·ï¼Œæ”¯æŒç”Ÿæˆ `***@tangtangs.cn` æ ¼å¼çš„ä¸´æ—¶é‚®ç®±åœ°å€ï¼Œå¹¶æ¥æ”¶è½¬å‘åˆ°æŒ‡å®šé‚®ç®±çš„é‚®ä»¶ã€‚

## âœ¨ ç‰¹æ€§

### ğŸ¯ æ ¸å¿ƒåŠŸèƒ½
- âœ… ç”Ÿæˆæ— é™æ•°é‡çš„ä¸´æ—¶é‚®ç®±åœ°å€
- ğŸ“§ æ”¯æŒå‘é€æµ‹è¯•é‚®ä»¶åŠŸèƒ½
- ğŸ“¬ å®æ—¶æ¥æ”¶å’ŒæŸ¥çœ‹é‚®ä»¶å†…å®¹
- ğŸ”„ IMAPè½®è¯¢åŠŸèƒ½ï¼Œæ”¯æŒé‡è¯•æœºåˆ¶
- ğŸ” OTPéªŒè¯ç ä¿æŠ¤
- ğŸ’» ç°ä»£åŒ–Vue 3ç•Œé¢
- ğŸŒ å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒç§»åŠ¨ç«¯

### ğŸ—ï¸ æ¶æ„ç‰¹æ€§
- ğŸš€ å¾®æœåŠ¡æ¶æ„ï¼Œæ˜“äºæ‰©å±•
- ğŸ“¦ æœåŠ¡ç‹¬ç«‹éƒ¨ç½²
- ğŸ³ Dockerå®¹å™¨åŒ–æ”¯æŒ
- ğŸ”§ å¼€å‘æ¨¡å¼çƒ­é‡è½½
- ğŸ“Š æœåŠ¡å¥åº·æ£€æŸ¥
- ğŸ¨ Vue 3 + Viteå‰ç«¯

## ğŸ“‹ ç³»ç»Ÿè¦æ±‚

- Node.js 18+ æˆ– Docker
- npm æˆ– pnpm
- å¯é€‰ï¼šæœ‰æ•ˆçš„SMTP/IMAPé‚®ç®±æœåŠ¡

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼ä¸€ï¼šæœ¬åœ°å¼€å‘ï¼ˆæ¨èç”¨äºå¼€å‘ï¼‰

#### 1. å…‹éš†é¡¹ç›®å¹¶å®‰è£…ä¾èµ–

```bash
# å®‰è£…åç«¯ä¾èµ–
npm install

# å®‰è£…å‰ç«¯ä¾èµ–
cd frontend
npm install
cd ..
```

#### 2. é…ç½®ç¯å¢ƒå˜é‡

```bash
cp .env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œé…ç½®ä½ çš„é‚®ç®±ä¿¡æ¯ï¼ˆå¯é€‰ï¼Œä¸é…ç½®ä¹Ÿèƒ½è¿è¡Œæ¼”ç¤ºæ¨¡å¼ï¼‰ï¼š

```env
# SMTPé…ç½®
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-password

# IMAPé…ç½®
IMAP_HOST=imap.gmail.com
IMAP_PORT=993
IMAP_USER=your-email@gmail.com
IMAP_PASS=your-app-password
```

#### 3. å¯åŠ¨æ‰€æœ‰æœåŠ¡

**å¼€å‘æ¨¡å¼ï¼ˆæ¨èï¼‰**:
```bash
# ç»ˆç«¯1: å¯åŠ¨å¾®æœåŠ¡ï¼ˆå¸¦çƒ­é‡è½½ï¼‰
npm run microservices:dev

# ç»ˆç«¯2: å¯åŠ¨Vueå‰ç«¯ï¼ˆå¸¦çƒ­é‡è½½ï¼‰
npm run frontend:dev
```

**æ™®é€šæ¨¡å¼**:
```bash
# ç»ˆç«¯1: å¯åŠ¨å¾®æœåŠ¡
npm run microservices

# ç»ˆç«¯2: å¯åŠ¨Vueå‰ç«¯
npm run frontend:dev
```

#### 4. è®¿é—®åº”ç”¨

- **å‰ç«¯ç•Œé¢**: http://localhost:5173
- **APIç½‘å…³**: http://localhost:3000

### æ–¹å¼äºŒï¼šç”Ÿäº§æ„å»º

#### 1. æ„å»ºå‰ç«¯

```bash
npm run frontend:build
```

#### 2. å¯åŠ¨å¾®æœåŠ¡

```bash
npm run microservices
```

#### 3. è®¿é—®åº”ç”¨

æ‰“å¼€æµè§ˆå™¨è®¿é—®: http://localhost:3000

### æ–¹å¼ä¸‰ï¼šDockeréƒ¨ç½²ï¼ˆæ¨èç”¨äºç”Ÿäº§ï¼‰

#### 1. æ„å»ºå‰ç«¯

```bash
npm run frontend:build
```

#### 2. å¯åŠ¨Dockerå®¹å™¨

```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡
npm run docker:up

# æˆ–ç›´æ¥ä½¿ç”¨docker-compose
docker-compose up -d
```

#### 3. æŸ¥çœ‹æ—¥å¿—

```bash
npm run docker:logs
```

#### 4. åœæ­¢æœåŠ¡

```bash
npm run docker:down
```

## ğŸ“– ä½¿ç”¨æŒ‡å—

### 1ï¸âƒ£ ç”Ÿæˆä¸´æ—¶é‚®ç®±

1. è®¿é—®é¦–é¡µ
2. ç‚¹å‡»"ç”Ÿæˆæ–°é‚®ç®±"æŒ‰é’®
3. ç³»ç»Ÿä¼šç”Ÿæˆä¸€ä¸ªä¸´æ—¶é‚®ç®±åœ°å€å’Œ6ä½OTPéªŒè¯ç 
4. å¤åˆ¶é‚®ç®±åœ°å€ä½¿ç”¨

### 2ï¸âƒ£ æŸ¥çœ‹æ”¶ä»¶ç®±

1. åœ¨é‚®ç®±åˆ—è¡¨ä¸­æ‰¾åˆ°ä½ çš„é‚®ç®±
2. ç‚¹å‡»"æŸ¥çœ‹æ”¶ä»¶ç®±"æŒ‰é’®
3. å¦‚éœ€éªŒè¯ï¼Œè¾“å…¥OTPéªŒè¯ç 
4. æŸ¥çœ‹æ”¶åˆ°çš„é‚®ä»¶

### 3ï¸âƒ£ å‘é€æµ‹è¯•é‚®ä»¶

1. åœ¨é¦–é¡µæ‰¾åˆ°"å‘é€æµ‹è¯•é‚®ä»¶"åŒºåŸŸ
2. è¾“å…¥æ”¶ä»¶é‚®ç®±ã€ä¸»é¢˜å’Œå†…å®¹
3. ç‚¹å‡»"å‘é€æµ‹è¯•é‚®ä»¶"
4. åˆ°æ”¶ä»¶ç®±åˆ·æ–°æŸ¥çœ‹é‚®ä»¶

### 4ï¸âƒ£ é…ç½®IMAP

1. è®¿é—®"é…ç½®"é¡µé¢
2. å¡«å†™IMAPæœåŠ¡å™¨ä¿¡æ¯
3. ç‚¹å‡»"æµ‹è¯•è¿æ¥"éªŒè¯é…ç½®
4. ç‚¹å‡»"ä¿å­˜é…ç½®"åº”ç”¨è®¾ç½®

### 5ï¸âƒ£ æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€

è®¿é—®"çŠ¶æ€"é¡µé¢æŸ¥çœ‹ï¼š
- SMTPè¿æ¥çŠ¶æ€
- IMAPè¿æ¥çŠ¶æ€
- é‚®ç®±æ€»æ•°
- é‚®ä»¶æ€»æ•°

## ğŸ—ï¸ æ¶æ„è¯´æ˜

### å¾®æœåŠ¡æ¶æ„å›¾

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Browser   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
                    â”‚ API Gateway â”‚ :3000
                    â”‚  + Frontend â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                  â”‚                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚Email Generator â”‚  â”‚Email Senderâ”‚  â”‚Email Receiver â”‚
â”‚     :3001      â”‚  â”‚   :3002    â”‚  â”‚    :3003      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                  â”‚                  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                  â”‚                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
â”‚ Config Service â”‚  â”‚Auth Serviceâ”‚
â”‚     :3004      â”‚  â”‚   :3005    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æœåŠ¡è¯´æ˜

| æœåŠ¡ | ç«¯å£ | èŒè´£ |
|------|------|------|
| API Gateway | 3000 | è¯·æ±‚è·¯ç”±ã€é™æ€æ–‡ä»¶æœåŠ¡ |
| Email Generator | 3001 | é‚®ç®±åœ°å€ç”Ÿæˆå’Œç®¡ç† |
| Email Sender | 3002 | SMTPé‚®ä»¶å‘é€ |
| Email Receiver | 3003 | IMAPé‚®ä»¶æ¥æ”¶ |
| Config Service | 3004 | é…ç½®ç®¡ç† |
| Auth Service | 3005 | OTPè®¤è¯ |
| Vue Frontend | 5173 | å¼€å‘æ¨¡å¼å‰ç«¯æœåŠ¡ |

è¯¦ç»†æ¶æ„è¯´æ˜è¯·æŸ¥çœ‹ [MICROSERVICES.md](./MICROSERVICES.md)

## ğŸ“ é¡¹ç›®ç»“æ„

```
.
â”œâ”€â”€ frontend/                  # Vue 3 å‰ç«¯
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/       # Vueç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ views/           # é¡µé¢è§†å›¾
â”‚   â”‚   â”œâ”€â”€ router/          # è·¯ç”±é…ç½®
â”‚   â”‚   â”œâ”€â”€ services/        # APIæœåŠ¡
â”‚   â”‚   â””â”€â”€ App.vue          # æ ¹ç»„ä»¶
â”‚   â”œâ”€â”€ public/              # é™æ€èµ„æº
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ microservices/            # å¾®æœåŠ¡
â”‚   â”œâ”€â”€ api-gateway/         # APIç½‘å…³
â”‚   â”œâ”€â”€ email-generator/     # é‚®ç®±ç”ŸæˆæœåŠ¡
â”‚   â”œâ”€â”€ email-sender/        # é‚®ä»¶å‘é€æœåŠ¡
â”‚   â”œâ”€â”€ email-receiver/      # é‚®ä»¶æ¥æ”¶æœåŠ¡
â”‚   â”œâ”€â”€ config-service/      # é…ç½®æœåŠ¡
â”‚   â””â”€â”€ auth-service/        # è®¤è¯æœåŠ¡
â”‚
â”œâ”€â”€ shared/                   # å…±äº«æ¨¡å—
â”‚   â”œâ”€â”€ config.js            # é…ç½®ç®¡ç†
â”‚   â””â”€â”€ storage.js           # å†…å­˜å­˜å‚¨
â”‚
â”œâ”€â”€ services/                 # åŸæœ‰æœåŠ¡ï¼ˆå¤ç”¨ï¼‰
â”‚   â”œâ”€â”€ emailService.js      # SMTPæœåŠ¡
â”‚   â””â”€â”€ imapPollerService.js # IMAPæœåŠ¡
â”‚
â”œâ”€â”€ app.js                    # åŸå•ä½“åº”ç”¨ï¼ˆä¿ç•™ï¼‰
â”œâ”€â”€ start-microservices.js   # å¾®æœåŠ¡å¯åŠ¨è„šæœ¬
â”œâ”€â”€ docker-compose.yml       # Dockerç¼–æ’
â””â”€â”€ package.json             # é¡¹ç›®ä¾èµ–
```

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### NPMè„šæœ¬

```bash
# å•ä½“åº”ç”¨ï¼ˆåŸç‰ˆï¼‰
npm start              # å¯åŠ¨åŸç‰ˆå•ä½“åº”ç”¨
npm run dev            # å¼€å‘æ¨¡å¼ï¼ˆnodemonï¼‰

# å¾®æœåŠ¡
npm run microservices      # å¯åŠ¨æ‰€æœ‰å¾®æœåŠ¡
npm run microservices:dev  # å¼€å‘æ¨¡å¼ï¼ˆçƒ­é‡è½½ï¼‰

# å‰ç«¯
npm run frontend:dev       # å¯åŠ¨Vueå¼€å‘æœåŠ¡å™¨
npm run frontend:build     # æ„å»ºç”Ÿäº§ç‰ˆæœ¬

# Docker
npm run docker:up          # å¯åŠ¨å®¹å™¨
npm run docker:down        # åœæ­¢å®¹å™¨
npm run docker:logs        # æŸ¥çœ‹æ—¥å¿—
```

### æ·»åŠ æ–°æœåŠ¡

1. åœ¨ `microservices/` ä¸‹åˆ›å»ºæ–°æœåŠ¡ç›®å½•
2. åˆ›å»º `index.js` å…¥å£æ–‡ä»¶
3. åœ¨ `shared/config.js` æ·»åŠ æœåŠ¡é…ç½®
4. åœ¨ `start-microservices.js` æ·»åŠ å¯åŠ¨è„šæœ¬
5. åœ¨ `api-gateway/index.js` æ·»åŠ è·¯ç”±è½¬å‘
6. åœ¨ `docker-compose.yml` æ·»åŠ æœåŠ¡å®šä¹‰

### APIå¼€å‘

æ‰€æœ‰APIé€šè¿‡API Gatewayç»Ÿä¸€æš´éœ²ï¼š

```javascript
// åœ¨ç›¸åº”çš„å¾®æœåŠ¡ä¸­å®šä¹‰ç«¯ç‚¹
app.get('/your-endpoint', (req, res) => {
  // å¤„ç†é€»è¾‘
});

// åœ¨api-gatewayä¸­æ·»åŠ è·¯ç”±è½¬å‘
app.get('/api/your-endpoint', async (req, res) => {
  const result = await forwardRequest('yourService', '/your-endpoint');
  res.json(result);
});
```

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡

å‚è€ƒ `.env.example` æ–‡ä»¶ï¼š

```env
# å¾®æœåŠ¡ç«¯å£
API_GATEWAY_PORT=3000
EMAIL_GENERATOR_PORT=3001
EMAIL_SENDER_PORT=3002
EMAIL_RECEIVER_PORT=3003
CONFIG_SERVICE_PORT=3004
AUTH_SERVICE_PORT=3005

# SMTPé…ç½®
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-password

# IMAPé…ç½®
IMAP_HOST=imap.gmail.com
IMAP_PORT=993
IMAP_USER=your-email@gmail.com
IMAP_PASS=your-app-password
```

### Gmailé…ç½®

ä½¿ç”¨Gmailéœ€è¦ï¼š
1. å¼€å¯ä¸¤æ­¥éªŒè¯
2. ç”Ÿæˆåº”ç”¨ä¸“ç”¨å¯†ç 
3. åœ¨`.env`ä¸­ä½¿ç”¨åº”ç”¨å¯†ç 

### å‰ç«¯ä»£ç†é…ç½®

å¼€å‘æ¨¡å¼ä¸‹ï¼Œå‰ç«¯é€šè¿‡Viteä»£ç†è®¿é—®APIï¼š

```javascript
// frontend/vite.config.js
export default defineConfig({
  server: {
    proxy: {
      '/api': {
        target: 'http://localhost:3000',
        changeOrigin: true
      }
    }
  }
})
```

## ğŸ“Š ç›‘æ§å’Œç»´æŠ¤

### å¥åº·æ£€æŸ¥

æ¯ä¸ªæœåŠ¡éƒ½æä¾›å¥åº·æ£€æŸ¥ç«¯ç‚¹ï¼š

```bash
curl http://localhost:3001/health
curl http://localhost:3002/health
curl http://localhost:3003/health
curl http://localhost:3004/health
curl http://localhost:3005/health
```

### ç»Ÿä¸€å¥åº·æ£€æŸ¥

```bash
curl http://localhost:3000/api/health
```

### ç³»ç»ŸçŠ¶æ€

```bash
curl http://localhost:3000/api/status
```

## ğŸ› æ•…éšœæ’é™¤

### ç«¯å£è¢«å ç”¨

```bash
# æŸ¥æ‰¾å ç”¨ç«¯å£çš„è¿›ç¨‹
lsof -i :3000

# æ€æ­»è¿›ç¨‹
kill -9 <PID>
```

### æœåŠ¡æ— æ³•å¯åŠ¨

1. æ£€æŸ¥ä¾èµ–æ˜¯å¦å®‰è£…å®Œæ•´
2. ç¡®è®¤ç¯å¢ƒå˜é‡é…ç½®æ­£ç¡®
3. æŸ¥çœ‹ç«¯å£æ˜¯å¦è¢«å ç”¨
4. æ£€æŸ¥Node.jsç‰ˆæœ¬ (éœ€è¦18+)

### å‰ç«¯æ— æ³•è¿æ¥API

1. ç¡®è®¤API Gatewayè¿è¡Œåœ¨3000ç«¯å£
2. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯
3. éªŒè¯Viteä»£ç†é…ç½®
4. ç¡®è®¤CORSè®¾ç½®

### Dockerå®¹å™¨é—®é¢˜

```bash
# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
docker-compose logs -f <service-name>

# é‡æ–°æ„å»º
docker-compose build --no-cache

# å®Œå…¨é‡ç½®
docker-compose down -v
docker-compose up -d --build
```

## ğŸ”„ è¿ç§»æŒ‡å—

### ä»åŸç‰ˆè¿ç§»

åŸç‰ˆå•ä½“åº”ç”¨ä»ç„¶ä¿ç•™åœ¨ `app.js`ï¼Œå¯ä»¥ç»§ç»­ä½¿ç”¨ï¼š

```bash
# è¿è¡ŒåŸç‰ˆ
npm start
```

### æ•°æ®è¿ç§»

å½“å‰ç‰ˆæœ¬ä½¿ç”¨å†…å­˜å­˜å‚¨ï¼Œé‡å¯åæ•°æ®ä¼šä¸¢å¤±ã€‚å¦‚éœ€æŒä¹…åŒ–ï¼š

1. å®ç°Rediså­˜å‚¨é€‚é…å™¨
2. å®ç°æ•°æ®åº“å­˜å‚¨é€‚é…å™¨
3. æ›¿æ¢ `shared/storage.js` ä¸­çš„å®ç°

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å¾®æœåŠ¡æ¶æ„è¯¦è§£](./MICROSERVICES.md)
- [åŸç‰ˆä½¿ç”¨æŒ‡å—](./USAGE.md)
- [æ‰‹åŠ¨é…ç½®è¯´æ˜](./MANUAL_CONFIG.md)
- [åŸç‰ˆREADME](./README.md)

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

## ğŸ“„ è®¸å¯è¯

MIT License

## â­ æŠ€æœ¯æ ˆ

### åç«¯
- Node.js 18+
- Express.js
- Nodemailer (SMTP)
- imap-simple (IMAP)
- Axios (æœåŠ¡é—´é€šä¿¡)

### å‰ç«¯
- Vue 3
- Vue Router 4
- Vite 5
- Axios
- åŸç”ŸCSS

### éƒ¨ç½²
- Docker
- Docker Compose

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿æIssueï¼
